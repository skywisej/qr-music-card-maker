<!DOCTYPE html><html><body style="background:black;color:white;">
    <script>
    const params   = new URLSearchParams(location.search);
    const code     = params.get("code");
    const verifier = sessionStorage.getItem("hitster_verifier");
    if (!code || !verifier){
      document.body.textContent = "Login failed. Try again.";
      throw new Error("Missing code or verifier");
    }
    
    const data = new URLSearchParams({
      grant_type:        "authorization_code",
      client_id:         "f373adfc90734648bd432988e370ab64",          // same ID
      code,
      redirect_uri:      location.origin + "https://skywisej.github.io/qr-music-card-maker/",
      code_verifier:     verifier
    });
    
    fetch("https://accounts.spotify.com/api/token", {
      method: "POST",
      headers: { "Content-Type":"application/x-www-form-urlencoded" },
      body: data
    })
    .then(r => r.json())
    .then(js => {
      if (js.access_token){
        sessionStorage.setItem("hitster_token", js.access_token);
        location.href = "cards/html/track1.html";        // start deck
      }else{
        document.body.textContent = "Token exchange failed.";
      }
    });
    </script></body></html>
    